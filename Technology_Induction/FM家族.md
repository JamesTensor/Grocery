

# FM：

参考：<https://tech.meituan.com/2016/03/03/deep-understanding-of-ffm-principles-and-practices.html>

推荐系统算法实践P115



FM常用于CTR预估，其可以看成是对逻辑回归的优化，使得逻辑回归也可以用机器来做特征工程。

其主要目标是在数据稀疏的情况下，用模型来做特征交叉。（特征交叉可以发掘特征之间的关联性）目标解读：我们假设一个场景：数据包含用户id，性别，年龄，地区特征来预测对口红的点击率。如果性别为女而且年轻，那么他对口红的点击率应该高，这说明性别和年龄有关联，需要在多项式后，加一项（系数a*x1*x2），这就是特征交叉，让模型把这个当成新的特征，理解为年轻女性，那么这项系数应该是比较大的。但是现实中的数据可能年轻女性比较少，只有当女性和年轻两个特征都为1的数据才能用来训练系数a，数据过少导致系数a的值不精确。这就是人工特征+LR的不足之处。FM来解决这个问题。

![LR多项式](/Users/wjj/Desktop/推荐系统笔记/LR多项式.png)



上图为人工特征工程+LR的公式，其中的wij为W矩阵的一项，W矩阵记录了所有特征之间的交叉系数。我们将W矩阵分解，得到的向量点击后就可以复原W矩阵中的任何一项。变成下式：



![FM公式](/Users/wjj/Desktop/推荐系统笔记/FM公式.png)



FM的核心优点：由于矩阵分解，需要学习的参数就大大下降了。而且解决了交叉特征的数据稀疏问题。



# FFM:

在FM的基础上引入了“场（Field）”的概念。

在FM中计算特征 x 与其他特征的交叉影响时，使用的都是同一个隐向量 。而FFM的特征x有多个隐向量，每个场对应一个隐向量。 当两个特征![ffm1](/Users/wjj/Desktop/推荐系统笔记/ffm1.svg) ,组合时，用对方对应的场对应的隐向量做内积:

![ffm2](/Users/wjj/Desktop/推荐系统笔记/ffm2.png)

FFM 由于引入了场，使得每两组特征交叉的隐向量都是独立的，可以取得更好的组合效果， FM 可以看做只有一个场的 FFM。



# DeepFM：

将wide&deep模型的wide侧改为FM就是deepfm。

wide侧主要是提供记忆功能，处理本来就稠密的低维特征；deep侧是提供泛化性能，将高维稀疏的特征如id类变得稠密连续。

FM里本来就有一个LR，这里提供一阶特征；FM有做二阶特征交叉；高阶的特征交叉交给dnn处理。



# xdeepFM

https://zhuanlan.zhihu.com/p/92855031

https://zhuanlan.zhihu.com/p/45450361

http://www.huaxiaozhuan.com/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapters/9_ctr_prediction2.html

http://www.shataowei.com/2019/12/17/xDeepFM%E6%9E%B6%E6%9E%84%E7%90%86%E8%A7%A3%E5%8F%8A%E5%AE%9E%E7%8E%B0/

自己只总结了CIN模块：

1、根据前一层隐层的状态和原特征矩阵，计算出一个中间结果矩阵

2、在这个中间结果上，我们用多个卷积核生成下一层隐层的状态，卷积核的感受野是全图。

3、卷积核的结果sum pool后输出。























































